function preparehashtags(e,t,a){if(hasher.getHash()){var s=!0,n=hasher.getHashAsArray();text="";for(var i=0;i<n.length;i++)cr=n[i],str=cr.split("="),console.log(str[0]),"offset"==str[0]&&1==a&&(console.log(str[0],0),n[i]="offset=1"),str[0]==e&&(s=!1,n[i]=e+"="+t),text+=n[i]+"/";s&&(text+=e+"="+t+"/"),text=text.replace(/\/\s*$/,""),hasher.setHash(text)}else hasher.setHash(e+"="+t)}function getEventResponse(e,t){$("#toolbar").show(),$(".modal-backdrop").remove(),$("#event_detail").hide(),$("#cal_viewchanger").show(),$("#search_cntr").hide(),$("#data-list").empty(),$("#data-list").fullCalendar("destroy"),$("#data-list").fullCalendar("render"),$("#data-list").fullCalendar({header:{left:"prev,next today",center:"title",right:""},defaultView:e,defaultDate:new Date,editable:!0,eventLimit:!0,eventClick:function(e){"weekly"==e.event_type?$.confirm({text:"Do you want to edit the series or only this date ?",title:"Confirmation required",confirm:function(){hasher.setHash("event-weekly="+e._id)},cancel:function(){hasher.setHash("event-special="+e._id)},confirmButton:"Edit series",cancelButton:"Only this date",post:!0}):hasher.setHash("event-special="+e._id)},loading:function(e){$("#loading").toggle(e)},viewRender:function(){$("#loading").css("display","block"),$("#data-list").fullCalendar("removeEvents"),updateCalData()}}),t&&$("#data-list").fullCalendar("gotoDate",new Date(t))}function updateCalData(){view=$("#data-list").fullCalendar("getView");var e=view.start._d,t=e.getUTCMonth()+1,a=e.getUTCDate(),s=e.getUTCFullYear();a=10>a?"0"+String(a):String(a),t=10>t?"0"+String(t):String(t);var n=String(t)+"-"+String(a)+"-"+String(s),e=view.end._d,t=e.getUTCMonth()+1,a=e.getUTCDate(),s=e.getUTCFullYear();a=10>a?"0"+String(a):String(a),t=10>t?"0"+String(t):String(t);var i=String(t)+"-"+String(a)+"-"+String(s);240==(new Date).getTimezoneOffset()&&(timezone="America/New_York"),420==(new Date).getTimezoneOffset(),$.get(base_url+"admin/events/cal_view/"+n+"/"+i,function(e){data=jQuery.parseJSON(e);for(var t=0;t<data.length;t++)data[t].start=moment(data[t].start_datetime).tz(timezone).format(),data[t].end=moment(data[t].end_datetime).tz(timezone).format();$("#data-list").fullCalendar("removeEvents"),$("#data-list").fullCalendar("addEventSource",data,!0),$("#loading").css("display","none")})}function getDataResponse(){$('<div class="modal-backdrop fade in" ><img class="loading-gif" src="'+base_url+'assets/images/load.gif"/></div>').appendTo(document.body);var e=$("#section_list").data("section"),t=hasher.getHashAsArray();dtext={};for(var a=0;a<t.length;a++)dkey=t[a],keyval=dkey.split("="),dval=keyval[1]?keyval[1]:"",dtext[keyval[0]]=dval;switch(e){case"chat":url=base_url+"admin/chat/ajax_list",ejs="chat_list.ejs",exp_uri="admin/chat/export";break;case"user":"undefined"==typeof dtext.view_type||"list"==dtext.view_type?(url=base_url+"admin/user/ajax_list",ejs="user_list.ejs"):"grid"==dtext.view_type&&(url=base_url+"admin/user/ajax_list",ejs="user_grid.ejs"),exp_uri="admin/user/export";break;case"venue":url=base_url+"admin/venue/ajax_list",ejs="venue_list.ejs",exp_uri="admin/venue/export";break;case"hostings":url=base_url+"admin/hostings/ajax_list",ejs="hosting_list.ejs",exp_uri="admin/hostings/export";break;case"adminuser":url=base_url+"admin/adminuser/ajax_list",ejs="adminuser_list.ejs",exp_uri="admin/adminuser/export";break;case"blocklists":url=base_url+"admin/blocklists/ajax_list",ejs="block_list.ejs",exp_uri="";break;case"events":url=base_url+"admin/events/ajax_list",ejs="event_list.ejs",exp_uri=""}if(setHostingfilter(dtext),"events"==e&&"calendar"==dtext.view_type){var s="basicWeek",n="";("basicWeek"==dtext.view||"month"==dtext.view||"basicDay"==dtext.view)&&(s=dtext.view);var i=Date.parse(dtext.start_date);return 0==isNaN(i)&&(n=dtext.start_date),$("#cal_viewchanger").find("."+s).addClass("fc-state-active"),getEventResponse(s,n),console.log(n,"goTodate",start_date),void 0}$.ajax({type:"POST",url:url,dataType:"json",data:dtext,success:function(e){e.siteurl=base_url;var t=new EJS({url:base_url+"assets/js/ejs/"+ejs+"?v="+$.now()}).render(e);$("#test-heading").show(),$("#toolbar").show(),$("#cal_viewchanger").hide(),$("#search_cntr").show(),$("#data-list").html(t),$(".modal-backdrop").remove(),$("#paginate_count").html(""),"hostings"==e.current_controller&&$("#hostingsdata-search").val(e.data_search),$("#data-search").val(e.data_search),$("#sort-list").select2("val",e.paginate.per_page),$("#paginate_link").bootpag({total:e.paginate.total_page,page:e.paginate.offset,maxVisible:5,leaps:!0,firstLastUse:!0,first:"←",last:"→"}).on("page",function(e,t){preparehashtags("offset",t,!1)}),$(".export_options").attr("href",base_url+exp_uri+"/?"+hasher.getHash())},complete:function(){parseInt($(".dataTable").find("tbody").find("tr").length)<parseInt($("#toolbar").find(".select2-choice").find(".select2-chosen").html())?$("#paginate_count").html($(".dataTable").find("tbody").find("tr").length):$("#paginate_count").html($("#toolbar").find(".select2-choice").find(".select2-chosen").html()),$("#data-list").find(".dataTable th").each(function(){$(this).removeClass("sorting_desc").removeClass("sorting_asc"),$(this).attr("data-field")==$(".panel-body").attr("sort_field")&&$(this).addClass("sorting_"+$(".panel-body").attr("sort_val"))}),$(".confirm").confirm({text:"Are you sure you want to delete this user?",title:"Confirmation required",confirm:function(e){window.location.href=e.attr("data-url")},cancel:function(){},confirmButton:"Yes",cancelButton:"No",post:!0});$("#img-tems")}})}function setHostingfilter(e){e.hasOwnProperty("search_venue")?$("#search-venue").select2("val",e.search_venue):$("#search-venue").select2("val",""),e.hasOwnProperty("search_promoter")?$("#search-promoter").select2("val",e.search_promoter):$("#search-promoter").select2("val",""),e.hasOwnProperty("search_verified")?$("#search-verified").select2("val",e.search_verified):$("#search-verified").select2("val",""),e.hasOwnProperty("search_recurring")?$("#search-recurring").select2("val",e.search_recurring):$("#search-recurring").select2("val","")}function getUserDetailPage(e,t){$.ajax({type:"POST",url:e,dataType:"json",data:"",success:function(e){if(e.siteurl=base_url,ejsfile="detail"==t?"user_detail.ejs":"user_image.ejs",e.error)var a=new EJS({url:base_url+"assets/js/ejs/error.ejs?v="+$.now()}).render(e);else var a=new EJS({url:base_url+"assets/js/ejs/"+ejsfile+"?v="+$.now()}).render(e);$("#test-heading").hide(),$("#toolbar").hide(),$("#data-list").html(a),$(".modal-backdrop").remove()},complete:function(){$.fn.editable.defaults.mode="inline",$(".edit_user").editable({type:"text",pk:1,url:base_url+"admin/user/save/"+$("#selected_user").attr("user_id"),emptytext:"Please enter text"}),$("#fname,#lname").editable({type:"text",pk:1,url:base_url+"admin/user/save/"+$("#selected_user").attr("user_id"),emptytext:"Name",validate:function(e){return $.trim(e)?void 0:"Required field!"}}),$("#fbid").editable({type:"text",pk:1,url:base_url+"admin/user/save/"+$("#selected_user").attr("user_id"),emptytext:"Facebook ID",validate:function(e){return(e+"").match(/^\d+$/)?void 0:"Please enter valid Facebook ID"}}),$(".user-detail").find("#email").editable({type:"text",pk:1,url:base_url+"admin/user/save_usermail/"+$("#selected_user").attr("user_id"),emptytext:"Email",success:function(e){var t=jQuery.parseJSON(e);return"error"==t.status?"Please enter a valid email address":"taken"==t.status?"Email address is already used":void 0}}),$(".user-detail").find("#phone").editable({type:"text",pk:1,url:base_url+"admin/user/save/"+$("#selected_user").attr("user_id"),emptytext:"Phone",validate:function(e){return(e+"").match(/^\d+$/)?10!=e.length?"Please enter valid Phone number":void 0:"Please enter valid Phone number"}}),$(".datepicker,.datepicker_event").on("changeDate",function(){$(this).datepicker("hide"),$("[data-rel=datepicker]").trigger("blur")}),$("#dob").editable({url:base_url+"admin/user/savebirthday/"+$("#selected_user").attr("user_id"),validate:function(e){var t=moment(),a=moment(e);return a>t?"Please enter valid birth date":void 0}}),$("[name='verified_host'],[name='suspend_user'],[name='gender']").bootstrapSwitch(),$("input[name='gender']").on("switchChange.bootstrapSwitch",function(){null!=$("#selected_user").attr("user_id")&&$.ajax({type:"POST",url:base_url+"admin/user/save/"+$("#selected_user").attr("user_id"),data:{value:this.value,name:this.name},success:function(){$("#data_error").text("")}})}),$("input[name='verified_host']").on("switchChange.bootstrapSwitch",function(e,t){var a=1==t?1:0,s=base_url+"admin/user/verified_host/"+Math.random();null!=$("#selected_user").attr("user_id")&&$.ajax({type:"POST",url:s,data:{data:a,user:$("#selected_user").attr("user_id")},success:function(){}})}),$("input[name='suspend_user']").on("switchChange.bootstrapSwitch",function(e,t){var a=base_url+"admin/user/suspend_user/"+Math.random(),s=1==t?5:1;null!=$("#selected_user").attr("user_id")&&$.ajax({type:"POST",url:a,data:{data:s,user:$("#selected_user").attr("user_id")},success:function(){}})}),enableDeleteButton()}})}function getHostingDetailPage(e){$('<div class="modal-backdrop fade in" ><img class="loading-gif" src="'+base_url+'assets/images/load.gif"/></div>').appendTo(document.body),$.ajax({type:"POST",url:e,dataType:"json",data:"",success:function(e){if(e.error)var t=new EJS({url:base_url+"assets/js/ejs/error.ejs?v="+$.now()}).render(e);else var t=new EJS({url:base_url+"assets/js/ejs/hosting_detail.ejs?v="+$.now()}).render(e.data);$("#test-heading").hide(),$("#toolbar").hide(),$("#data-list").html(t),$(".modal-backdrop").remove()},complete:function(){$.fn.editable.defaults.mode="inline",$("[name='is_recurring'],[name='is_promoter'],[name='promoter'],[name='hstatus']").bootstrapSwitch(),$("input[name='is_recurring'],[name='is_promoter'],[name='promoter'],[name='hstatus']").on("switchChange.bootstrapSwitch",function(e,t){var a=0,s=$(this).attr("name");t&&(a=1),null!=$("#selected_hosting").attr("hosting_id")&&$.ajax({type:"POST",url:base_url+"admin/hostings/save/"+$("#selected_hosting").attr("hosting_id"),data:{value:a,hosting:$("#selected_hosting").attr("hosting_id"),name:s},success:function(e){$("#data_error").text(""),"D"==e?$("#data_error").text("Venue already booked"):"F"==e&&$("#data_error").text("Updated Failed")}})}),$(".edit_host, #user_image_url").editable({type:"text",pk:0,url:base_url+"admin/hostings/save/"+$("#selected_hosting").attr("hosting_id"),success:function(e){"D"==e||("F"==e?$("#data_error").text("Updated Failed"):($("#p_"+$(this).attr("id")).html(e),$("#data_error").text("")))}});var e=[];for(i=1;100>=i;i+=1)tmp={value:i,text:i},e.push(tmp);$("#view_rank").find("#rank").editable({source:e,type:"text",pk:0,url:base_url+"admin/hostings/save/"+$("#selected_hosting").attr("hosting_id"),success:function(e){$(".save_error").html(""),"success"!=e&&$(".save_error").html(e)}}),$("#host_date").editable({url:base_url+"admin/hostings/save/"+$("#selected_hosting").attr("hosting_id"),validate:function(e){var t=moment(),a=moment(e);return t>a?"Please enter valid Hosting date":void 0}}),$("#host_description").editable({url:base_url+"admin/hostings/save/"+$("#selected_hosting").attr("hosting_id"),showbuttons:"bottom"}),enableDeleteButton()}})}function getVenueDetailPage(e,t){$.ajax({type:"POST",url:e,dataType:"json",data:"",success:function(e){if(e.siteurl=base_url,ejsfile="detail"==t?"venue_detail.ejs":"venue_image.ejs",e.error)var a=new EJS({url:base_url+"assets/js/ejs/error.ejs?v="+$.now()}).render(e);else var a=new EJS({url:base_url+"assets/js/ejs/"+ejsfile+"?v="+$.now()}).render(e);$("#test-heading").hide(),$("#toolbar").hide(),$("#data-list").html(a),$(".modal-backdrop").remove()},complete:function(){$.fn.editable.defaults.mode="inline",$("[name='venue_status']").bootstrapSwitch(),$("input[name='venue_status']").on("switchChange.bootstrapSwitch",function(e,t){var a=0,s=$(this).attr("name");t&&(a=1),null!=$("#selected_venue").attr("venue_id")&&$.ajax({type:"POST",url:base_url+"admin/venue/save/"+$("#selected_venue").attr("venue_id"),data:{value:a,name:s},success:function(){}})});var e=[];for(i=1;100>=i;i+=1)tmp={value:i,text:i},e.push(tmp);$("#rank").editable({source:e,type:"text",pk:1,url:base_url+"admin/venue/save/"+$("#selected_venue").attr("venue_id"),success:function(e){$(".save_error").html(""),"success"!=e&&$(".save_error").html(e)}}),$(".edit_venue").editable({type:"text",pk:1,url:base_url+"admin/venue/save/"+$("#selected_venue").attr("venue_id"),success:function(e){$(".save_error").html(""),"success"!=e&&$(".save_error").html(e)}}),$(".edit_venue_url").editable({type:"text",pk:1,url:base_url+"admin/venue/save/"+$("#selected_venue").attr("venue_id"),emptytext:"Url",validate:function(e){return(e+"").match(/^(http|https|ftp):\/\/[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/)?void 0:"Please enter valid url. eg http://google.com"}}),$(".edit_venuephone").editable({type:"text",pk:1,url:base_url+"admin/venue/save/"+$("#selected_venue").attr("venue_id"),emptytext:"Phone",validate:function(e){return(e+"").match(/^\d+$/)?10!=e.length?"Please enter valid Phone number":void 0:"Please enter valid Phone number"}}),$(".edit_venuelat").editable({type:"text",pk:1,url:base_url+"admin/venue/save/"+$("#selected_venue").attr("venue_id"),validate:function(e){return!e.match(/^(\-?\d+(\.\d+)?)$/)&&$.trim(e)?"Please enter valid data":void 0}}),$("#venue_description").editable({url:base_url+"admin/venue/save/"+$("#selected_venue").attr("venue_id"),showbuttons:"bottom"}),enableDeleteButton()}})}function getEventDetailPage(e,t){$("#data-list").empty(),$('<div class="modal-backdrop fade in" ><img class="loading-gif" src="'+base_url+'assets/images/load.gif"/></div>').appendTo(document.body),$.ajax({type:"POST",url:e,dataType:"json",data:"",success:function(e){e.siteurl=base_url,ejsfile="weekly"==t?"event_seriesdetail.ejs":"event_detail.ejs";var a=new EJS({url:base_url+"assets/js/ejs/"+ejsfile+"?v="+$.now()}).render(e);$("#data-list").html(a),$("#test-heading").hide(),$("#toolbar").hide(),$(".modal-backdrop").remove(),$("#loading").css("display","none")},complete:function(e){console.log(e.responseJSON.venue._id),$.fn.editable.defaults.mode="inline","weekly"==t?enableweeklyeventedit(e):enablespecialeventedit(e)}})}function enablespecialeventedit(e){$("#eventvenue").editable({value:e.responseJSON.venue._id,source:function(){var e;return $.ajax({url:base_url+"admin/events/allvenues/",type:"GET",data:{},global:!1,async:!1,dataType:"json",success:function(t){dat_obj=t,venue="[";for(prop in dat_obj)venue+='{"value":"'+dat_obj[prop]._id+'", "text":"'+dat_obj[prop].name+'"},';venue+="]",e=venue}}),e}}),$(".edit_event").editable({type:"text",pk:1,url:base_url+"admin/events/editspecial/"+$("#selected_event").attr("_id"),emptytext:"Please enter text",validate:function(e){return $.trim(e)?void 0:"Required field!"}}),$("#event_status").editable({type:"text",pk:1,value:e.responseJSON.status,url:base_url+"admin/events/editspecial/"+$("#selected_event").attr("_id"),source:[{value:"draft",text:"Draft"},{value:"published",text:"Published"},{value:"passed",text:"Passed"},{value:"inactive",text:"Inactive"},{value:"soldout",text:"Sold Out"}]}),$("#event_featured").editable({type:"text",pk:1,url:base_url+"admin/events/editspecial/"+$("#selected_event").attr("_id"),value:e.responseJSON.source,source:[{value:"admin",text:"Admin"},{value:"user",text:"User"},{value:"featured",text:"Featured"}]});var t=[];for(i=0;10>=i;i+=1)tmp={value:i,text:i},t.push(tmp);$("#event_rank").editable({type:"text",pk:1,url:base_url+"admin/events/editspecial/"+$("#selected_event").attr("_id"),value:e.responseJSON.rank,source:t}),$("#event_tags").editable({type:"text",pk:1,url:base_url+"admin/events/editspecial/"+$("#selected_event").attr("_id"),source:[{id:"house",text:"House / EDM"},{id:"hiphop",text:"Hip Hop"},{id:"top40s",text:"Top 40s"},{id:"dance",text:"Dance"},{id:"nightclub",text:"Nightclub"},{id:"lounge",text:"Lounge"},{id:"hotellounge",text:"Hotel Lounge"},{id:"rooftop",text:"Rooftop"},{id:"restaurent",text:"Restaurant"},{id:"redcarpet",text:"Red Carpet"},{id:"upscalechic",text:"Upscale Chic"},{id:"casual",text:"Casual"}],select2:{multiple:!0,viewseparator:","}}),$("#file-4").fileinput({uploadUrl:base_url+"admin/events/addimage",allowedFileExtensions:["png"],maxFileCount:5,uploadExtraData:function(){var e={};return e.event_id=$("#selected_event").attr("_id"),e.method="addeventsimage",e}})}function enableweeklyeventedit(e){$("#eventvenue").editable({value:e.responseJSON.venue._id,source:function(){var e;return $.ajax({url:base_url+"admin/events/allvenues/",type:"GET",data:{},global:!1,async:!1,dataType:"json",success:function(t){dat_obj=t,venue="[";for(prop in dat_obj)venue+='{"value":"'+dat_obj[prop]._id+'", "text":"'+dat_obj[prop].name+'"},';venue+="]",e=venue}}),e}}),$(".edit_event").editable({type:"text",pk:1,url:base_url+"admin/events/edit/"+$("#selected_event").attr("event_id"),emptytext:"Please enter text",validate:function(e){return $.trim(e)?void 0:"Required field!"}}),$("#event_status").editable({type:"text",pk:1,value:e.responseJSON.status,url:base_url+"admin/events/edit/"+$("#selected_event").attr("event_id"),source:[{value:"draft",text:"Draft"},{value:"published",text:"Published"},{value:"passed",text:"Passed"},{value:"inactive",text:"Inactive"},{value:"soldout",text:"Sold Out"}]}),$("#event_featured").editable({type:"text",pk:1,url:base_url+"admin/events/edit/"+$("#selected_event").attr("event_id"),value:e.responseJSON.source,source:[{value:"admin",text:"Admin"},{value:"user",text:"User"},{value:"featured",text:"Featured"}]});var t=[];for(i=0;10>=i;i+=1)tmp={value:i,text:i},t.push(tmp);$("#event_rank").editable({type:"text",pk:1,url:base_url+"admin/events/edit/"+$("#selected_event").attr("event_id"),value:e.responseJSON.rank,source:t}),$("#event_tags").editable({type:"text",pk:1,url:base_url+"admin/events/edit/"+$("#selected_event").attr("event_id"),source:[{id:"house",text:"House / EDM"},{id:"hiphop",text:"Hip Hop"},{id:"top40s",text:"Top 40s"},{id:"dance",text:"Dance"},{id:"nightclub",text:"Nightclub"},{id:"lounge",text:"Lounge"},{id:"hotellounge",text:"Hotel Lounge"},{id:"rooftop",text:"Rooftop"},{id:"restaurent",text:"Restaurant"},{id:"redcarpet",text:"Red Carpet"},{id:"upscalechic",text:"Upscale Chic"},{id:"casual",text:"Casual"}],select2:{multiple:!0,viewseparator:","}}),$("#file-4").fileinput({uploadUrl:base_url+"admin/events/addimage",allowedFileExtensions:["png"],maxFileCount:5,uploadExtraData:function(){var e={};return e.event_id=$("#selected_event").attr("event_id"),e.method="addeventimage",e}})}function enableDeleteButton(){$(".confirm").confirm({text:"Are you sure you want to delete this "+$(".confirm").attr("data-type")+"?",title:"Confirmation required",confirm:function(e){window.location.href=e.attr("data-url")},cancel:function(){},confirmButton:"Yes",cancelButton:"No",post:!0})}function getOverviewGraph(e){if($('<div class="modal-backdrop fade in" ><img class="loading-gif" src="'+base_url+'assets/images/load.gif"/></div>').appendTo(document.body),$("#ph_overviewgrpah").html(""),$("#data-set1").select2("data"))var t=$("#data-set1").select2("data").id,a=$("#data-set1").select2("data").text;else var t="",a="Select a metric";if($("#data-set2").select2("data"))var s=$("#data-set2").select2("data").id,n=$("#data-set2").select2("data").text;else var s="",n="Select a metric";var i=$("#goptions").find("a.active").attr("id");i=i?i:e,$.ajax({type:"POST",data:{set1:t,set2:s,period:i},dataType:"json",url:base_url+"admin/home/getgraph",success:function(e){Morris.Line({element:"ph_overviewgrpah",data:e,xkey:"date",ykeys:["a","b"],labels:[a,n],lineColors:["#EFB55B","#E8524E"],lineWidth:2,pointSize:4,parseTime:!1,gridLineColor:"rgba(255,255,255,.5)",gridTextColor:"#fff",hideHover:!0,resize:!0,smooth:!1}),$(".modal-backdrop").remove()}})}function loadListing(e){realodAjaxList(e)}function realodAjaxList(){}function format(e){var t=e.element;return $(t).data("name")}function formatselected(e){var t=e.element;return $(t).data("id")&&$("#selected_search_venue").val($(t).data("id")),$(t).data("name")}function formatselected_recurring(e){var t=e.element;return $("#selected_search_recurring").val($(t).data("id")),$(t).data("name")}function formatselected_promoter(e){var t=e.element;return $("#selected_search_promoter").val($(t).data("id")),$(t).data("name")}function formatselected_verified(e){var t=e.element;return $("#selected_search_verified").val($(t).data("id")),$(t).data("name")}function convertToServerTimeZone(e){var t=4,a=new Date(e),s=a.getTime()+6e4*a.getTimezoneOffset(),n=new Date(s-36e5*t);return n.getTime()}jQuery(function(e){"use strict";function t(t){var a=0;t.each(function(){var t=e(this).height();a=t>a?t:a}),t.height(a)}var a=e('<div class="grid-float-breakpoint" style="position:absolute;top:-9999px;width:1px;height:1px;"></div>'),s=e('<div class="visible-xs" style="position:absolute;top:-9999px;width:1px;height:1px;"></div>'),n=e('<div class="visible-sm" style="position:absolute;top:-9999px;width:1px;height:1px;"></div>');e("body").append(a).append(s).append(n),e("[data-sidebar-toggle]").on("click",function(){a.is(":visible")?e("body").toggleClass("sidebar-condensed"):e("body").toggleClass("sidebar-opened")}),e(".sidebar .nav").navgoco({caretHtml:!1,accordion:!0,onClickBefore:function(){if(e("body").hasClass("sidebar-condensed")){var t=e(this).parent();if(t.parent().hasClass("nav"))return t.siblings().removeClass("nav-dropdown-open"),t.hasClass("nav-dropdown")&&t.toggleClass("nav-dropdown-open"),!1}return!0}}),e('[data-rel="collapse"]').on("click",function(){var t=e(this),a=t.closest(".panel");return a.hasClass("collapsed")?(t.children(".fa").removeClass("fa-plus").addClass("fa-minus"),a.children('[class!="panel-heading"]').slideDown(300,function(){a.removeClass("collapsed")})):(t.children(".fa").removeClass("fa-minus").addClass("fa-plus"),a.children('[class!="panel-heading"]').slideUp(300,function(){a.addClass("collapsed")})),!1}),e('[data-rel="reload"]').on("click",function(){return!1}),e('[data-rel="close"]').on("click",function(){}),e('[data-toggle="tooltip"]').tooltip().on("show.bs.tooltip",function(){var t=e(this).data("style");t&&""!==t&&e(this).data("bs.tooltip").tip().addClass("tooltip-"+t)}),e('[data-toggle="popover"]').popover().on("show.bs.popover",function(){var t,a,s=e(this).data("style")||"";if(a=s.split(" "),a.length>0){for(t in a)a[t]="popover-"+a[t];e(this).data("bs.popover").tip().addClass(a.join(" "))}}),e("[data-sync-height]").each(function(){t(e(this).children())}),e(".mail-navigation .active").on("click",function(t){return s.is(":visible")||n.is(":visible")?(t.preventDefault(),e(this).closest(".mail-navigation").toggleClass("open"),!1):void 0}),e.fn.wysihtml5&&(e.fn.wysihtml5.defaultOptions=e.extend({},e.fn.wysihtml5.defaultOptions,{color:!0}))}),$(document).ready(function(){function e(e){if(str_h=e.split("="),"details"==str_h[0]){var t=base_url+"admin/user/user_details/"+str_h[1];getUserDetailPage(t,"detail")}else if("profle_images"==str_h[0]){var t=base_url+"admin/user/user_details/"+str_h[1];getUserDetailPage(t,"profile")}else if("hosting-details"==str_h[0]){var t=base_url+"admin/hostings/details/"+str_h[1];getHostingDetailPage(t)}else if("venue-details"==str_h[0]){var t=base_url+"admin/venue/venue_details/"+str_h[1];getVenueDetailPage(t,"detail")}else if("venue_images"==str_h[0]){var t=base_url+"admin/venue/venue_details/"+str_h[1];getVenueDetailPage(t,"profile")}else if("event-special"==str_h[0]){var t=base_url+"admin/events/event_details/"+str_h[1];getEventDetailPage(t,"special")}else if("event-weekly"==str_h[0]){var t=base_url+"admin/events/event_details/"+str_h[1];getEventDetailPage(t,"weekly")}else getDataResponse()}if($("#section_list").length&&(hasher.changed.add(e),hasher.initialized.add(e),hasher.init()),"events"==controller_JS){var t=moment().add(6,"months");auto_range={start:moment(),end:moment().add(6,"months")},auto_range={},auto_range.start=moment(),auto_range.end=moment().add(6,"months"),preset_options=[{text:"All",dateStart:function(){return moment()},dateEnd:function(){return t}},{text:"Today",dateStart:function(){return moment()},dateEnd:function(){return moment()}},{text:"Tomorrow ",dateStart:function(){return moment().add("days",1)},dateEnd:function(){return moment().add("days",1)}},{text:"Next 7 Days",dateStart:function(){return moment().add("days",1)},dateEnd:function(){return moment().add("days",7)}},{text:"Next 30 Days",dateStart:function(){return moment().add("days",1)},dateEnd:function(){return moment().add("days",30)}},{text:"Custom",dateStart:function(){return moment()},dateEnd:function(){return moment().add("days",30)}}]}else{var t=moment();max_date=0,auto_range={},auto_range.start=moment("2014-04-01T01:00:00-04:00"),auto_range.end=moment(),preset_options=[{text:"All",dateStart:function(){return moment("2014-04-01")},dateEnd:function(){return t}},{text:"Today",dateStart:function(){return moment()},dateEnd:function(){return moment()}},{text:"Yesterday",dateStart:function(){return moment().subtract("days",1)},dateEnd:function(){return moment().subtract("days",1)}},{text:"Last 7 Days",dateStart:function(){return moment().subtract("days",7)},dateEnd:function(){return moment().subtract("days",1)}},{text:"Previous 7 Days",dateStart:function(){return moment().subtract("days",14)},dateEnd:function(){return moment().subtract("days",8)}},{text:"Last 30 Days",dateStart:function(){return moment().subtract("days",30)},dateEnd:function(){return moment().subtract("days",1)}},{text:"Previous 30 Days",dateStart:function(){return moment().subtract("days",60)},dateEnd:function(){return moment().subtract("days",31)}},{text:"Custom",dateStart:function(){return moment().subtract("days",30)},dateEnd:function(){return moment()}}]}$("#e1").daterangepicker1({presetRanges:preset_options,applyOnMenuSelect:!1,datepickerOptions:{maxDate:"+6m"},initStart:moment(start_date_JS+"T01:00:00-04:00"),initEnd:moment(end_date_JS+"T01:00:00-04:00"),initSel:int_sel,autorange:{start:moment("2014-04-01T01:00:00-04:00"),end:moment().add(6,"months")}}),$("#e1").on("change.daterangepicker",function(){var e=$("#e1").daterangepicker1("getRange"),t=base_url+"admin/home/dateRange/"+Math.random();$.ajax({type:"POST",url:t,data:{startDate:$.datepicker.formatDate("mm/dd/yy",e.start),endDate:$.datepicker.formatDate("mm/dd/yy",e.end),selected:$("#e1").attr("data-sel")},success:function(){location.reload()}})}),$("#sort-list").select2({minimumResultsForSearch:-1}),$("#rank_h").select2({minimumResultsForSearch:-1}),$("#search-venue").select2({placeholder:"Select Venue",allowClear:!0,formatSelection:formatselected,formatResult:format,formatNoMatches:function(){return $("#selected_search_venue").val(""),"No venue found"}}).on("select2-selecting",function(e){preparehashtags("search_venue",e.val,!0)}).on("select2-removed",function(){$("#selected_search_venue").val(""),preparehashtags("search_venue","",!0)}),$("#search-recurring").select2({placeholder:"Is Recurring",allowClear:!0,minimumResultsForSearch:-1,formatSelection:formatselected_recurring,formatResult:format}).on("select2-selecting",function(e){preparehashtags("search_recurring",e.val,!0)}).on("select2-removed",function(){preparehashtags("search_recurring","",!0),$("#selected_search_recurring").val("")}),$("#search-promoter").select2({placeholder:"Is Promoter",allowClear:!0,minimumResultsForSearch:-1,formatSelection:formatselected_promoter,formatResult:format}).on("select2-selecting",function(e){preparehashtags("search_promoter",e.val,!0)}).on("select2-removed",function(){preparehashtags("search_promoter","",!0),$("#selected_search_promoter").val("")}),$("#search-verified").select2({placeholder:"Is Verified",allowClear:!0,minimumResultsForSearch:-1,formatSelection:formatselected_verified,formatResult:format}).on("select2-selecting",function(e){preparehashtags("search_verified",e.val,!0)}).on("select2-removed",function(){preparehashtags("search_verified","",!0),$("#selected_search_verified").val("")}),$("#sort_status").select2({minimumResultsForSearch:-1}).on("select2-selecting",function(e){preparehashtags("sort_status",e.val,!0)}).on("select2-removed",function(){$("#selected_sort_status").val(""),preparehashtags("search_venue","",!0)}),$("#sort-list").on("change",function(){preparehashtags("per_page",$("#toolbar").find(".select2-choice").find(".select2-chosen").html(),!0)}),$("#sort-formsearch").on("click",function(){preparehashtags("search_name",$("#data-search").val(),!0)}),$("#data-search").on("keypress",function(e){"13"==e.keyCode&&preparehashtags("search_name",$("#data-search").val(),!0)}),$("#formsearch").on("click",function(){preparehashtags("search_name",$("#data-search").val(),!0)}),$("#hostingsformsearch").on("click",function(){preparehashtags("search_name",$("#hostingsdata-search").val(),!0)}),$("#hostingsdata-search").on("keypress",function(e){"13"==e.keyCode&&preparehashtags("search_name",$("#hostingsdata-search").val(),!0)}),$("#displayselection").on("click","a",function(e){e.preventDefault(),preparehashtags("view_type",$(this).data("dispaly"),!1)}),$("#displayeventselection").on("click","a",function(e){e.preventDefault(),$(this).siblings().removeClass("fc-state-active"),$(this).addClass("fc-state-active"),preparehashtags("view_type",$(this).data("dispaly"),!1)}),$("body").find(".panel-body").off("click").on("click","th",function(){$(this).hasClass("sorting")&&($(".panel-body").attr("sort_field",$(this).attr("data-field")),$(this).hasClass("sorting_asc")?($(this).removeClass("sorting_asc").addClass("sorting_desc"),$(".panel-body").attr("sort_val","desc")):($(this).removeClass("sorting_desc").addClass("sorting_asc"),$(".panel-body").attr("sort_val","asc")),$(".dataTable th").not(this).each(function(){$(this).removeClass("sorting_desc").removeClass("sorting_asc")}),preparehashtags("sort_field",$(".panel-body").attr("sort_field"),!1),preparehashtags("sort_val",$(".panel-body").attr("sort_val"),!1))}),$(".img-edit-link").click(function(e){e.stopPropagation(),$("#show"+$(this).attr("id")).toggle()}),$(".photo-drop li a").mouseout(function(){}),$("body").click(function(e){$(e.target).hasClass("img-edit")||$(".photo-drop").hide()}),$(".upload-text").on("click",function(e){e.stopPropagation();var t=$(this).attr("trigger");$("#"+t).css({width:"0px",height:"0px"}),$("#"+t).removeClass("hidden")}),$(".p-phptos").on("click",".del-image",function(e){e.stopPropagation(),$.ajax({type:"POST",url:$(this).attr("url"),data:{old_img:$(this).attr("old-image-id"),id:$(this).attr("row-id"),field:$(this).attr("data-field")},success:function(){},complete:function(){location.reload()}})}),$(".ucimageuploader").on("change",function(){if($(this).parent().attr("old-image-id"))var e=encodeURIComponent($(this).parent().attr("old-image-id"));else e="";var t=$(this).attr("form-id"),a=$("#"+t).attr("action");$("#"+t).attr("action",a+$(this).attr("name")+"/"+$(this).attr("data-field")+"/"+$(this).attr("data-for")+"/?img="+e),$("#"+t).ajaxForm({success:function(){location.reload()}}).submit()}),$(document.body).on("click",".change-upload-photo",function(e){e.stopPropagation(),$("#oldphoto_image_id").val(""),$("#oldphoto_image_id").val($(this).attr("old-image-id")),image=$(this).attr("trigger"),$("#"+image).css({width:"0px",height:"0px"}),$("#"+image).removeClass("hidden")}),$(".sidebar").height($(document).height());var a=$("#img-tems");if(a.imagesLoaded(function(){$(".panel-body .thumbnail").on({mouseenter:function(){},mouseleave:function(){}})}),$("#data-list").on("click","#chat_sec_api .chatrow",function(e){e.preventDefault(),$("#conversation").remove(),$(".modal-backdrop").remove(),path=base_url+"admin/chat/conversation/"+$(this).data("topic")+"/"+$(this).data("from"),$("#serviceModal").remove(),$.ajax({type:"POST",url:path,dataType:"json",success:function(e){var t=new EJS({url:base_url+"assets/js/ejs/chat_conversation.ejs?v="+$.now()}).render(e);$modal=$('<div class="modal " id="conversation"></div>'),$modal.html(t),$("body").append($modal),$modal.modal({backdrop:"static",keyboard:!0}),$modal.show()
}})}),$("#data-set1").select2({placeholder:"Select a metric",allowClear:!0,formatSelection:formatselected,formatResult:format,formatNoMatches:function(){return"No metric found"}}),$("#data-set2").select2({placeholder:"Select a metric",allowClear:!0,formatSelection:formatselected,formatResult:format,formatNoMatches:function(){return"No metric found"}}),$("#data-set1").on("change",function(){getOverviewGraph()}),$("#data-set2").on("change",function(){getOverviewGraph()}),$("#goptions").on("change","a",function(){getOverviewGraph($(this).attr("id"))}),$("#ph_overviewgrpah").length&&getOverviewGraph(),$("#section_list").on("click",".stud_detail",function(e){base_url+"admin/user/user_details/"+$(this).data("user_id");hasher.setHash("details="+$(this).data("user_id")),e.preventDefault()}),$("#section_list").on("click",".profile_image",function(e){base_url+"admin/user/user_details/"+$(this).data("user_id");hasher.setHash("profle_images="+$(this).data("user_id")),e.preventDefault()}),$("#section_list").on("click",".host_detail",function(e){e.preventDefault(),$("#section_list").data("clickedfrom","list"),$("#section_list").data("clickedfromurl",hasher.getHash());base_url+"admin/hostings/details/"+$(this).data("hosting_id");hasher.setHash("hosting-details="+$(this).data("hosting_id"))}),$("#section_list").on("click",".venue_detail",function(e){e.preventDefault();base_url+"admin/venue/venue_details/"+$(this).data("venue_id");hasher.setHash("venue-details="+$(this).data("venue_id"))}),$("#section_list").on("click",".venue_image",function(e){base_url+"admin/venue/image/"+$(this).data("venue_id");hasher.setHash("venue_images="+$(this).data("venue_id")),e.preventDefault()}),$("#section_list").on("click",".event_detail",function(e){e.preventDefault(),pop_event=this,$("#section_list").data("clickedfrom","list"),$("#section_list").data("clickedfromurl",hasher.getHash()),"weekly"==$(this).data("event_type")?$.confirm({text:"Do you want to edit the series or only this date ?",title:"Confirmation required",confirm:function(){hasher.setHash("event-weekly="+$(pop_event).data("event_id"))},cancel:function(){hasher.setHash("event-special="+$(pop_event).data("event_id"))},confirmButton:"Edit series",cancelButton:"Only this date",post:!0}):hasher.setHash("event-special="+$(this).data("event_id"))}),$("#section_list").on("click",".pagebackbtn",function(e){e.preventDefault(),window.history.back()}),$(".navbar").on("click",".detail_close",function(e){e.preventDefault(),"list"==$("#section_list").data("clickedfrom")?hasher.setHash($("#section_list").data("clickedfromurl")):window.location.href=base_url+"admin/"+controller_JS}),$("#section_events").on("click",".detail_close",function(e){e.preventDefault(),window.history.back()}),$("#section_list").on("click","#delete_event_details",function(e){e.preventDefault(),$.confirm({text:"Do you want to delete this event ?",title:"Confirmation required",confirm:function(){$.ajax({type:"POST",url:base_url+"admin/events/delete",data:{event_id:$(this).data("event_id"),mevent_id:$(this).data("mevent_id")},success:function(e){e=jQuery.parseJSON(e),1==e.success&&("list"==$("#section_list").data("clickedfrom")?hasher.setHash($("#section_list").data("clickedfromurl")):window.location.href=base_url+"admin/"+controller_JS)}})},cancel:function(){},confirmButton:"Delete Event",cancelButton:"Cancel",post:!0})}),$("#location").val($("#venue_sel").find("option:selected").data("location")),$(".event_range_start").val()){var s=new TimeShift.OriginalDate($(".event_range_start").val()+" "+$("#starttime").val());localendtime=s.setHours(s.getHours()+parseInt($("#event_time").val())),$("#endtime ").val(dateFormats(localendtime,"mmm dd,yyyy h:MM tt")),$("#end_time ").val(dateFormats(localendtime,"mmm dd,yyyy h:MM tt"))}"special"==$("#event_type").val()?($("#endrangeselection").hide(),$("#startdatelabel").html("Start date")):($("#startdatelabel").html("Start series date"),$("#endrangeselection").show()),$("#venue_sel").change(function(){var e=$(this).find("option:selected"),t=e.data("location");$("#location").val(t)}),$("#event_type").change(function(){$(this).find("option:selected");"special"==$(this).val()?($("#endrangeselection").hide(),$("#startdatelabel").html("Start date")):($("#startdatelabel").html("Start series date"),$("#endrangeselection").show())}),$(".event_range_start").datepicker({changeMonth:!0,changeYear:!0,yearRange:date.getFullYear()+" : 2044",minDate:"+0d",dateFormat:"M dd, yy",onSelect:function(e){console.log("date",e),console.log("starttime",$("#starttime").val()),console.log("event_time",$("#event_time").val()),$(".event_range").trigger("blur");var t=new TimeShift.OriginalDate(e+" "+$("#starttime").val());localendtime=t.setHours(t.getHours()+parseInt($("#event_time").val())),$("#endtime ").val(dateFormats(localendtime,"mmm dd,yyyy h:MM tt")),$("#end_time ").val(dateFormats(localendtime,"mmm dd,yyyy h:MM tt"))}}),$("#event_time").change(function(){var e=new TimeShift.OriginalDate($(".event_range_start").val()+" "+$("#starttime").val());localendtime=e.setHours(e.getHours()+parseInt($("#event_time").val())),$("#endtime ").val(dateFormats(localendtime,"mmm dd,yyyy h:MM tt")),$("#end_time ").val(dateFormats(localendtime,"mmm dd,yyyy h:MM tt"))}),$(".event_range").datepicker({changeMonth:!0,changeYear:!0,yearRange:date.getFullYear()+" : 2044",minDate:"+0d",dateFormat:"M dd, yy",onSelect:function(){$(".event_range").trigger("blur")}}),$("#event_tags").select2({placeholder:"Select tags"}).on("select2-selecting",function(e){console.log(e.val)}),$("#section_list").on("click",".event-file-remove",function(e){e.preventDefault();var t=$(this).data("type");event_id="special"==t?$("#selected_event").attr("_id"):$("#selected_event").attr("event_id"),path=base_url+"admin/events/removeimage/"+event_id,$.ajax({type:"POST",url:path,data:{url:$(this).data("url"),type:$(this).data("type")},dataType:"json",success:function(){},complete:function(){location.reload()}})}),$("#section_list").on("click",".view-buttoncal",function(e){e.preventDefault(),$(this).siblings().removeClass("fc-state-active"),$(this).addClass("fc-state-active"),preparehashtags("view",$(this).data("view"),!1)})});